<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CricTV | Live</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="https://wallpaperaccess.in/public/uploads/preview/tata-ipl-2022-logo-png-images-z.png"
    />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body
    class="font-sans bg-gray-200 text-white min-h-screen flex flex-col items-center justify-center"
  >
  <header class="bg-[#003e92] w-full">
    <h1 class="text-3xl font-bold text-white md:ml-[130px]">CricTV</h1>
    <h1 class="text-xs mb-2 text-white md:ml-[130px]">by Nishant Siwakoti</h1>
  </div>
  </header>
  
      <div class="stream-container">
        <select
          id="language-select"
          class="p-2 text-lg bg-[#003e92] mt-2 text-white rounded-full mr-4 focus:outline-none"
        ></select>
        <video
          id="stream-video"
          controls
          autoplay
          class="w-full h-full rounded-lg shadow-lg mt-4 "
        ></video>
      </div>
      <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
      <script>
        document.addEventListener("DOMContentLoaded", async function () {
          const response = await fetch("m3u8.json");
          const data = await response.json();
          const languageSelect = document.getElementById("language-select");

          data.streams.forEach((stream) => {
            const option = document.createElement("option");
            option.value = stream.url;
            option.textContent = stream.language;
            languageSelect.appendChild(option);
          });

          const videoElement = document.getElementById("stream-video");
          const playButton = document.getElementById("play-button");
          const fullscreenButton = document.getElementById("fullscreen-button");
          const vlcButton = document.getElementById("open-vlc");

          let isPlaying = false;
          let currentStreamUrl = languageSelect.value;

          loadAndPlayStream(currentStreamUrl);

          function loadAndPlayStream(streamUrl) {
            if (Hls.isSupported()) {
              const hls = new Hls();
              hls.loadSource(streamUrl);
              hls.attachMedia(videoElement);
              hls.on(Hls.Events.MANIFEST_PARSED, function () {
                videoElement.play();
                isPlaying = true;
                playButton.textContent = "Pause";
              });
            } else {
              alert("HLS is not supported by your browser.");
            }
          }


          fullscreenButton.addEventListener("click", () => {
            if (videoElement.requestFullscreen) {
              videoElement.requestFullscreen();
            } else if (videoElement.webkitRequestFullscreen) {
              videoElement.webkitRequestFullscreen();
            }
          });

          languageSelect.addEventListener("change", () => {
            currentStreamUrl = languageSelect.value;
            loadAndPlayStream(currentStreamUrl);
          });
        });
      </script>
    </div>
  </body>
</html>
